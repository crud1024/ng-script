<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰¹é‡æ–‡ä»¶è½¬PNGè½¬æ¢å™¨ç¤ºä¾‹</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .container {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        button {
            background: #4285f4;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #3367d6;
        }
        .log {
            background: #fff;
            border: 1px solid #ddd;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            margin-top: 20px;
            font-family: monospace;
        }
        .sample-data {
            background: #e8f0fe;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>æ‰¹é‡æ–‡ä»¶è½¬PNGè½¬æ¢å™¨</h1>
    
    <div class="container">
        <h2>åŠŸèƒ½è¯´æ˜</h2>
        <p>æ­¤è½¬æ¢å™¨æ”¯æŒä»¥ä¸‹æ–‡ä»¶æ ¼å¼ï¼š</p>
        <ul>
            <li><strong>PDFæ–‡ä»¶</strong> - è½¬æ¢æ¯ä¸€é¡µä¸ºå•ç‹¬çš„PNGå›¾ç‰‡</li>
            <li><strong>å›¾ç‰‡æ–‡ä»¶</strong> - JPGã€PNGã€GIFã€BMPç­‰æ ¼å¼è½¬æ¢ä¸ºPNG</li>
            <li><strong>Wordæ–‡æ¡£</strong> - DOCã€DOCXæ ¼å¼ï¼ˆç®€åŒ–å¤„ç†ï¼‰</li>
            <li><strong>PPTæ–‡æ¡£</strong> - PPTã€PPTXæ ¼å¼ï¼ˆç®€åŒ–å¤„ç†ï¼‰</li>
            <li><strong>Excelæ–‡æ¡£</strong> - XLSã€XLSXæ ¼å¼ï¼ˆç®€åŒ–å¤„ç†ï¼‰</li>
        </ul>
    </div>

    <div class="container">
        <h2>ä½¿ç”¨ç¤ºä¾‹</h2>
        
        <div class="sample-data">
            <h3>ç¤ºä¾‹æ•°æ®ç»“æ„ï¼š</h3>
            <pre>
const sampleData = [
    {
        u_cert_name_level: "CERT001",
        u_zwmc: "äº§å“è¯´æ˜ä¹¦.pdf",
        u_zswj: "file_id_001"
    },
    {
        u_cert_name_level: "IMG002", 
        u_zwmc: "äº§å“ç…§ç‰‡.jpg",
        u_zswj: "file_id_002"
    },
    {
        u_cert_name_level: "DOC003",
        u_zwmc: "æŠ€æœ¯æ–‡æ¡£.docx", 
        u_zswj: "file_id_003"
    }
];
            </pre>
        </div>

        <button onclick="testPDFConversion()">æµ‹è¯•PDFè½¬æ¢</button>
        <button onclick="testImageConversion()">æµ‹è¯•å›¾ç‰‡è½¬æ¢</button>
        <button onclick="testMixedConversion()">æµ‹è¯•æ··åˆæ ¼å¼è½¬æ¢</button>
        <button onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
    </div>

    <div class="log" id="logOutput"></div>

    <!-- å¼•å…¥è½¬æ¢å™¨ -->
    <script src="./BatchP2P.js"></script>
    
    <script>
        // æ—¥å¿—è¾“å‡ºå‡½æ•°
        function log(message) {
            const logElement = document.getElementById('logOutput');
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        // æ¸…ç©ºæ—¥å¿—
        function clearLog() {
            document.getElementById('logOutput').innerHTML = '';
        }

        // æµ‹è¯•PDFè½¬æ¢
        function testPDFConversion() {
            log('å¼€å§‹æµ‹è¯•PDFè½¬æ¢...');
            
            const pdfData = [{
                u_cert_name_level: "PDF_TEST_001",
                u_zwmc: "æµ‹è¯•æ–‡æ¡£.pdf",
                u_zswj: "test_pdf_001"
            }];
            
            try {
                new BatchPDFToPNGConverter({
                    dataList: pdfData,
                    logo: "æµ‹è¯•æ°´å°",
                    baseUrl: window.location.origin,
                    scale: 2.0
                });
                log('âœ… PDFè½¬æ¢å™¨å·²å¯åŠ¨');
            } catch (error) {
                log(`âŒ å¯åŠ¨å¤±è´¥: ${error.message}`);
            }
        }

        // æµ‹è¯•å›¾ç‰‡è½¬æ¢
        function testImageConversion() {
            log('å¼€å§‹æµ‹è¯•å›¾ç‰‡è½¬æ¢...');
            
            const imageData = [{
                u_cert_name_level: "IMG_TEST_001", 
                u_zwmc: "æµ‹è¯•å›¾ç‰‡.jpg",
                u_zswj: "test_img_001"
            }];
            
            try {
                new BatchPDFToPNGConverter({
                    dataList: imageData,
                    logo: "æµ‹è¯•æ°´å°",
                    baseUrl: window.location.origin
                });
                log('âœ… å›¾ç‰‡è½¬æ¢å™¨å·²å¯åŠ¨');
            } catch (error) {
                log(`âŒ å¯åŠ¨å¤±è´¥: ${error.message}`);
            }
        }

        // æµ‹è¯•æ··åˆæ ¼å¼è½¬æ¢
        function testMixedConversion() {
            log('å¼€å§‹æµ‹è¯•æ··åˆæ ¼å¼è½¬æ¢...');
            
            const mixedData = [
                {
                    u_cert_name_level: "MIXED_001",
                    u_zwmc: "PDFæ–‡æ¡£.pdf",
                    u_zswj: "mixed_001"
                },
                {
                    u_cert_name_level: "MIXED_002",
                    u_zwmc: "å›¾ç‰‡æ–‡ä»¶.png", 
                    u_zswj: "mixed_002"
                },
                {
                    u_cert_name_level: "MIXED_003",
                    u_zwmc: "Wordæ–‡æ¡£.docx",
                    u_zswj: "mixed_003"
                }
            ];
            
            try {
                new BatchPDFToPNGConverter({
                    dataList: mixedData,
                    logo: "æ··åˆæµ‹è¯•æ°´å°",
                    baseUrl: window.location.origin
                });
                log('âœ… æ··åˆæ ¼å¼è½¬æ¢å™¨å·²å¯åŠ¨');
            } catch (error) {
                log(`âŒ å¯åŠ¨å¤±è´¥: ${error.message}`);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸš€ æ‰¹é‡æ–‡ä»¶è½¬PNGè½¬æ¢å™¨å·²åŠ è½½');
            log('ğŸ’¡ ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æµ‹è¯•ä¸åŒæ ¼å¼çš„è½¬æ¢åŠŸèƒ½');
            log('ğŸ“‹ æ”¯æŒPDFã€å›¾ç‰‡ã€Wordã€PPTã€Excelç­‰å¤šç§æ ¼å¼');
        });
    </script>
</body>
</html>