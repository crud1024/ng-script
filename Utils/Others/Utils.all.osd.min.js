!function(){"use strict";var e={"./ListToLayer/V1/ListToLayer.js":function(e,t,r){},"./OrgOrProJectTreeEventBinder/V1/OrgOrProJectTreeEventBinder.js":function(e,t,r){class o{constructor(e={}){this.options={treeContainerSelector:".ant-tree-list-holder-inner",retryDelay:1e3,...e},this.observer=null,this.isInitialized=!1}static extractNumberCodeFromTitle(e){if(!e)return null;const t=e.match(/\[(\d+)\]/);return t?t[1]:null}static extractIdentifierCodeFromTitle(e){if(!e)return null;let t=e.match(/([A-Za-z]+)-([A-Za-z]+)-(\d+)/);if(t)return t[0];if(t=e.match(/([A-Za-z]+)-(\d+)-(\d+)/),t)return t[0];if(t=e.match(/([A-Za-z0-9]+(?:-[A-Za-z0-9]+){2,})/),t){if(t[0].split("-").length>=3)return t[0]}return null}_addTreeItemClickEvents(){const e=document.querySelector(this.options.treeContainerSelector);if(!e)return console.warn(`未找到树容器: ${this.options.treeContainerSelector}`),void setTimeout(()=>this._addTreeItemClickEvents(),this.options.retryDelay);const t=e.querySelectorAll('div[role="treeitem"]');if(0===t.length)return console.warn("树容器中没有找到树节点"),void setTimeout(()=>this._addTreeItemClickEvents(),this.options.retryDelay);t.forEach((e,t)=>{if(e.hasAttribute("data-code-event-added"))return;e.setAttribute("data-code-event-added","true");const r=e.onclick;e.addEventListener("click",o=>{this._handleTreeItemClick(e,t,r,o)})}),console.log(`成功为 ${t.length} 个树节点绑定了事件`)}_handleTreeItemClick(e,t,r,i){console.log(`点击了树节点 ${t+1}`);const n=e.querySelectorAll("span");let s=null,d=null;for(let e of n){const t=e.getAttribute("title");if(t&&(s||(s=o.extractNumberCodeFromTitle(t),s&&this._triggerNumberCodeEvent(s,t)),d||(d=o.extractIdentifierCodeFromTitle(t),d&&this._triggerIdentifierCodeEvent(d,t)),s&&d))break}if(this._logExtractionResult(s,d),r)try{r.call(e,i)}catch(e){console.error("执行原有点击事件时出错:",e)}}_triggerNumberCodeEvent(e,t){console.log(`提取到数字编码: ${e} (来自title: "${t}")`),"function"==typeof this.options.onNumberCodeExtracted&&this.options.onNumberCodeExtracted(e,t)}_triggerIdentifierCodeEvent(e,t){console.log(`提取到标识符编码: ${e} (来自title: "${t}")`),"function"==typeof this.options.onIdentifierCodeExtracted&&this.options.onIdentifierCodeExtracted(e,t)}_logExtractionResult(e,t){e||t?e?t||console.log("未找到标识符编码，但找到了数字编码"):console.log("未找到数字编码，但找到了标识符编码"):console.log("未找到任何编码格式")}_observeTreeChanges(){this.observer&&this.observer.disconnect(),this.observer=new MutationObserver(e=>{e.forEach(e=>{if("childList"===e.type&&e.addedNodes.length>0){let t=!1;e.addedNodes.forEach(e=>{1===e.nodeType&&(e.matches&&e.matches('div[role="treeitem"]')&&(t=!0),e.querySelector&&e.querySelector('div[role="treeitem"]')&&(t=!0))}),t&&setTimeout(()=>this._addTreeItemClickEvents(),100)}})}),this.observer.observe(document.body,{childList:!0,subtree:!0})}init(){this.isInitialized?console.warn("TreeCodeEventBinder 已经初始化过了"):setTimeout(()=>{this._addTreeItemClickEvents(),this._observeTreeChanges(),this.isInitialized=!0,console.log("TreeCodeEventBinder 初始化完成")},500)}destroy(){this.observer&&(this.observer.disconnect(),this.observer=null);const e=document.querySelector(this.options.treeContainerSelector);if(e){e.querySelectorAll('div[role="treeitem"][data-code-event-added]').forEach(e=>{e.removeAttribute("data-code-event-added"),e.onclick=null})}this.isInitialized=!1,console.log("TreeCodeEventBinder 已销毁")}rebind(){this.destroy(),this.init()}triggerNumberCodeEvent(e){"function"==typeof this.options.onNumberCodeExtracted&&this.options.onNumberCodeExtracted(e,"手动触发")}triggerIdentifierCodeEvent(e){"function"==typeof this.options.onIdentifierCodeExtracted&&this.options.onIdentifierCodeExtracted(e,"手动触发")}}void 0!==e&&e.exports?e.exports=o:"function"==typeof define&&define.amd?define("TreeCodeEventBinder",[],()=>o):window.TreeCodeEventBinder=o}},t={};function r(o){if(t[o])return t[o].exports;var i={exports:{}};return t[o]=i,e[o](i,i.exports,r),i.exports}var o="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;o.NG=o.NG||{},o.NG.Utils=o.NG.Utils||{},o.NG.Utils["ListToLayer/V1/ListToLayer"]=r("./ListToLayer/V1/ListToLayer.js"),o.NG.Utils["OrgOrProJectTreeEventBinder/V1/OrgOrProJectTreeEventBinder"]=r("./OrgOrProJectTreeEventBinder/V1/OrgOrProJectTreeEventBinder.js")}();